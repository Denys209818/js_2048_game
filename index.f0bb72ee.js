!function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}new(function(){var n,i;function l(t){!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,l),this.tiles=[],this.tempTiles=[],this.removedItems=[],this.changed=0,this.container=document.getElementById("tile-container"),t&&this.convertToTiles(t)}return n=[{key:"moveLeft",value:function(){var t=this,e=this.tiles.sort(function(e,n){return t.getCoords(e).x-t.getCoords(n).x}),n=!0,i=!1,l=void 0;try{for(var s,c=this,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)!function(){var t=s.value,e=c.getCoords(t);t.classList.remove(e.className);for(var n=0;c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(e.y,"--").concat(n))}).length>0&&!(++n>3););if(n>3&&(n=e.x),n<=3&&parseInt(e.x)!==n&&c.changed++,t.classList.add("tile-cell--".concat(e.y,"--").concat(n)),n>0){var i=n-1,l=c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(e.y,"--").concat(i))})[0];if(l){var o=l.querySelector(".tile-content"),r=t.querySelector(".tile-content");o.textContent===r.textContent&&!c.tempTiles.includes(l)&&(t.classList.remove("tile-cell--".concat(e.y,"--").concat(n)),t.classList.add("tile-cell--".concat(e.y,"--").concat(i)),t.classList.add("tile-cell--hide"),l.classList.remove("tile-cell--".concat(o.textContent)),l.classList.add("tile-cell--".concat(2*parseInt(o.textContent))),o.textContent=2*parseInt(o.textContent),c.tempTiles.push(l),c.removedItems.push(t),c.changed++)}}}()}catch(t){i=!0,l=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw l}}}},{key:"moveRight",value:function(){var t=this,e=this.tiles.sort(function(e,n){return t.getCoords(n).x-t.getCoords(e).x}),n=!0,i=!1,l=void 0;try{for(var s,c=this,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)!function(){var t=s.value,e=c.getCoords(t);t.classList.remove(e.className);for(var n=3;c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(e.y,"--").concat(n))}).length>0&&!(--n<0););if(n<0&&(n=e.x),n>=0&&parseInt(e.x)!==n&&c.changed++,t.classList.add("tile-cell--".concat(e.y,"--").concat(n)),n<3){var i=n+1,l=c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(e.y,"--").concat(i))})[0];if(l){var o=l.querySelector(".tile-content"),r=t.querySelector(".tile-content");o.textContent===r.textContent&&!c.tempTiles.includes(l)&&(t.classList.remove("tile-cell--".concat(e.y,"--").concat(n)),t.classList.add("tile-cell--".concat(e.y,"--").concat(i)),t.classList.add("tile-cell--hide"),l.classList.remove("tile-cell--".concat(o.textContent)),l.classList.add("tile-cell--".concat(2*parseInt(o.textContent))),o.textContent=2*parseInt(o.textContent),c.tempTiles.push(l),c.removedItems.push(t),c.changed++)}}}()}catch(t){i=!0,l=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw l}}}},{key:"moveUp",value:function(){var t=this,e=this.tiles.sort(function(e,n){return t.getCoords(e).y-t.getCoords(n).y}),n=!0,i=!1,l=void 0;try{for(var s,c=this,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)!function(){var t=s.value,e=c.getCoords(t);t.classList.remove(e.className);for(var n=0;c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(n,"--").concat(e.x))}).length>0&&!(++n>3););if(n>3&&(n=e.y),n<=3&&parseInt(e.y)!==n&&c.changed++,t.classList.add("tile-cell--".concat(n,"--").concat(e.x)),n>0){var i=n-1,l=c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(i,"--").concat(e.x))})[0];if(l){var o=l.querySelector(".tile-content"),r=t.querySelector(".tile-content");o.textContent===r.textContent&&!c.tempTiles.includes(l)&&(t.classList.remove("tile-cell--".concat(n,"--").concat(e.x)),t.classList.add("tile-cell--".concat(i,"--").concat(e.x)),t.classList.add("tile-cell--hide"),l.classList.remove("tile-cell--".concat(o.textContent)),l.classList.add("tile-cell--".concat(2*parseInt(o.textContent))),o.textContent=2*parseInt(o.textContent),c.tempTiles.push(l),c.removedItems.push(t),c.changed++)}}}()}catch(t){i=!0,l=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw l}}}},{key:"moveDown",value:function(){var t=this,e=this.tiles.sort(function(e,n){return t.getCoords(n).y-t.getCoords(e).y}),n=!0,i=!1,l=void 0;try{for(var s,c=this,o=e[Symbol.iterator]();!(n=(s=o.next()).done);n=!0)!function(){var t=s.value,e=c.getCoords(t);t.classList.remove(e.className);for(var n=3;c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(n,"--").concat(e.x))}).length>0&&!(--n<0););if(n<0&&(n=e.y),n>=0&&parseInt(e.y)!==n&&c.changed++,t.classList.add("tile-cell--".concat(n,"--").concat(e.x)),n<3){var i=n+1,l=c.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(i,"--").concat(e.x))})[0];if(l){var o=l.querySelector(".tile-content"),r=t.querySelector(".tile-content");o.textContent===r.textContent&&!c.tempTiles.includes(l)&&(t.classList.remove("tile-cell--".concat(n,"--").concat(e.x)),t.classList.add("tile-cell--".concat(i,"--").concat(e.x)),t.classList.add("tile-cell--hide"),l.classList.remove("tile-cell--".concat(o.textContent)),l.classList.add("tile-cell--".concat(2*parseInt(o.textContent))),o.textContent=2*parseInt(o.textContent),c.tempTiles.push(l),c.removedItems.push(t),c.changed++)}}}()}catch(t){i=!0,l=t}finally{try{n||null==o.return||o.return()}finally{if(i)throw l}}}},{key:"getScore",value:function(){for(var t=this.getState(),e=0,n=0;n<4;n++)for(var i=0;i<4;i++)e+=t[n][i];return e}},{key:"getState",value:function(){for(var t=[],e=0;e<4;e++)t.push([0,0,0,0]);var n=!0,i=!1,l=void 0;try{for(var s,c=this.tiles.filter(function(t){return!t.classList.contains("tile-cell--hide")})[Symbol.iterator]();!(n=(s=c.next()).done);n=!0){var o=s.value,r=this.getCoords(o);t[r.y][r.x]=parseInt(o.querySelector(".tile-content").innerHTML)}}catch(t){i=!0,l=t}finally{try{n||null==c.return||c.return()}finally{if(i)throw l}}return t}},{key:"getStatus",value:function(){return this.tiles.filter(function(t){return 2048===parseInt(t.querySelector(".tile-content").innerHTML)}).length>0?"win":this.checkPosibilityToContinue()?document.getElementsByClassName("button")[0].classList.contains("start")?"idle":"playing":"lose"}},{key:"start",value:function(){var t=document.getElementsByClassName("button")[0];this.tiles=[],t.addEventListener("click",this.connectStart.bind(this)),document.addEventListener("keydown",this.press.bind(this))}},{key:"restart",value:function(){this.start()}},{key:"connectStart",value:function(t){t.preventDefault();var n,i=t.target;this.tiles=[],document.getElementById("tile-container").innerHTML="",i.classList.contains("start")&&(i.classList.remove("start"),i.classList.add("restart"),i.textContent="Restart"),this.spawnItem(),this.spawnItem();var l=((function(t){if(Array.isArray(t))return e(t)})(n=document.getElementsByClassName("message"))||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(n)||function(t,n){if(t){if("string"==typeof t)return e(t,n);var i=Object.prototype.toString.call(t).slice(8,-1);if("Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i)return Array.from(i);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return e(t,n)}}(n)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()).filter(function(t){return!t.classList.contains("hidden")})[0];l&&l.classList.add("hidden"),document.getElementsByClassName("message-start")[0].classList.remove("hidden")}},{key:"press",value:function(t){var e=this,n=t.key;if(this.tempTiles=[],this.removedItems=[],this.changed=0,0!==this.tiles.length){switch(n){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}this.sleep().then(function(){for(var t=0;t<e.removedItems.length;t++)e.removedItems[t].remove();if(e.changed>0&&e.spawnItem(),!e.checkPosibilityToContinue()){document.addEventListener("keydown",function(){});var n=e.getStatus();document.getElementsByClassName("message-start")[0].classList.add("hidden"),document.getElementsByClassName("message-".concat(n))[0].classList.remove("hidden")}})}}},{key:"setScoreHTML",value:function(){document.getElementsByClassName("game-score")[0].textContent=this.getScore()}},{key:"spawnItem",value:function(){var t=this.tiles.filter(function(t){return!t.classList.contains("tile-cell--hide")});if(t.length<16){for(var e=document.createElement("div"),n=2>Math.round(10*Math.random())?4:2,i=Math.floor(4*Math.random()),l=Math.floor(4*Math.random());t.filter(function(t){return t.classList.contains("tile-cell--".concat(l,"--").concat(i))}).length>0;)i=Math.floor(4*Math.random()),l=Math.floor(4*Math.random());e.classList.add("tile-cell"),e.classList.add("tile-cell--".concat(n)),e.classList.add("tile-cell--".concat(l,"--").concat(i)),e.classList.add("tile-cell--hide");var s=document.createElement("p");s.classList.add("tile-content"),s.textContent=n,e.appendChild(s),this.container.append(e),this.tiles.push(e),e.classList.remove("tile-cell--hide"),this.setScoreHTML()}}},{key:"sleep",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200;return new Promise(function(e){setTimeout(function(){e()},t)})}},{key:"getCoords",value:function(t){var e=0,n=0,i="",l=!0,s=!1,c=void 0;try{for(var o,r=t.classList[Symbol.iterator]();!(l=(o=r.next()).done);l=!0){var a=o.value;a.length>=15&&"tile-cell--hide"!==a&&(e=a.slice(-1),n=a.slice(-4,-3),i=a)}}catch(t){s=!0,c=t}finally{try{l||null==r.return||r.return()}finally{if(s)throw c}}return{x:e,y:n,className:i}}},{key:"checkPosibilityToContinue",value:function(){if(this.tiles=this.tiles.filter(function(t){return!t.classList.contains("tile-cell--hide")}),this.tiles.length>=16){for(var t=this,e=0;e<this.tiles.length;e++){var n=function(e){var n=t.tiles[e].querySelector(".tile-content"),i=t.getCoords(t.tiles[e]);if(i.x>0){var l=t.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(i.y,"--").concat(i.x-1))})[0];if(l&&n.textContent===l.querySelector(".tile-content").textContent)return{v:!0}}if(i.y>0){var s=t.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(i.y-1,"--").concat(i.x))})[0];if(s&&n.textContent===s.querySelector(".tile-content").textContent)return{v:!0}}if(i.y<3){var c=t.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(i.y+1,"--").concat(i.x))})[0];if(c&&n.textContent===c.querySelector(".tile-content").textContent)return{v:!0}}if(i.x<3){var o=t.tiles.filter(function(t){return t.classList.contains("tile-cell--".concat(i.y,"--").concat(i.x+1))})[0];if(o&&n.textContent===o.querySelector(".tile-content").textContent)return{v:!0}}}(e);if("object"==(n&&"undefined"!=typeof Symbol&&n.constructor===Symbol?"symbol":typeof n))return n.v}return!1}return!0}},{key:"convertToTiles",value:function(t){document.getElementById("tile-container").innerHTML="";for(var e=0;e<4;e++)for(var n=0;n<4;n++)if(t[e][n]>0){var i=document.createElement("div");i.classList.add("tile-cell"),i.classList.add("tile-cell--".concat(t[e][n])),i.classList.add("tile-cell--".concat(e,"--").concat(n));var l=document.createElement("p");l.classList.add("tile-content"),l.textContent=t[e][n],i.appendChild(l),document.getElementById("tile-container").appendChild(i),this.tiles.add(i)}}}],t(l.prototype,n),i&&t(l,i),l}())().start()}();
//# sourceMappingURL=index.f0bb72ee.js.map
