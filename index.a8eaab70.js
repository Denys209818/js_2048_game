new class{constructor(t){this.tiles=[],this.tempTiles=[],this.removedItems=[],this.changed=0,this.container=document.getElementById("tile-container"),t&&this.convertToTiles(t)}moveLeft(){for(let t of this.tiles.sort((t,e)=>this.getCoords(t).x-this.getCoords(e).x)){let e=this.getCoords(t);t.classList.remove(e.className);let s=0;for(;this.tiles.filter(t=>t.classList.contains(`tile-cell--${e.y}--${s}`)).length>0&&!(++s>3););if(s>3&&(s=e.x),s<=3&&parseInt(e.x)!==s&&this.changed++,t.classList.add(`tile-cell--${e.y}--${s}`),s>0){let l=s-1,i=this.tiles.filter(t=>t.classList.contains(`tile-cell--${e.y}--${l}`))[0];if(i){let n=i.querySelector(".tile-content"),o=t.querySelector(".tile-content");n.textContent===o.textContent&&!this.tempTiles.includes(i)&&(t.classList.remove(`tile-cell--${e.y}--${s}`),t.classList.add(`tile-cell--${e.y}--${l}`),t.classList.add("tile-cell--hide"),i.classList.remove(`tile-cell--${n.textContent}`),i.classList.add(`tile-cell--${2*parseInt(n.textContent)}`),n.textContent=2*parseInt(n.textContent),this.tempTiles.push(i),this.removedItems.push(t),this.changed++)}}}}moveRight(){for(let t of this.tiles.sort((t,e)=>this.getCoords(e).x-this.getCoords(t).x)){let e=this.getCoords(t);t.classList.remove(e.className);let s=3;for(;this.tiles.filter(t=>t.classList.contains(`tile-cell--${e.y}--${s}`)).length>0&&!(--s<0););if(s<0&&(s=e.x),s>=0&&parseInt(e.x)!==s&&this.changed++,t.classList.add(`tile-cell--${e.y}--${s}`),s<3){let l=s+1,i=this.tiles.filter(t=>t.classList.contains(`tile-cell--${e.y}--${l}`))[0];if(i){let n=i.querySelector(".tile-content"),o=t.querySelector(".tile-content");n.textContent===o.textContent&&!this.tempTiles.includes(i)&&(t.classList.remove(`tile-cell--${e.y}--${s}`),t.classList.add(`tile-cell--${e.y}--${l}`),t.classList.add("tile-cell--hide"),i.classList.remove(`tile-cell--${n.textContent}`),i.classList.add(`tile-cell--${2*parseInt(n.textContent)}`),n.textContent=2*parseInt(n.textContent),this.tempTiles.push(i),this.removedItems.push(t),this.changed++)}}}}moveUp(){for(let t of this.tiles.sort((t,e)=>this.getCoords(t).y-this.getCoords(e).y)){let e=this.getCoords(t);t.classList.remove(e.className);let s=0;for(;this.tiles.filter(t=>t.classList.contains(`tile-cell--${s}--${e.x}`)).length>0&&!(++s>3););if(s>3&&(s=e.y),s<=3&&parseInt(e.y)!==s&&this.changed++,t.classList.add(`tile-cell--${s}--${e.x}`),s>0){let l=s-1,i=this.tiles.filter(t=>t.classList.contains(`tile-cell--${l}--${e.x}`))[0];if(i){let n=i.querySelector(".tile-content"),o=t.querySelector(".tile-content");n.textContent===o.textContent&&!this.tempTiles.includes(i)&&(t.classList.remove(`tile-cell--${s}--${e.x}`),t.classList.add(`tile-cell--${l}--${e.x}`),t.classList.add("tile-cell--hide"),i.classList.remove(`tile-cell--${n.textContent}`),i.classList.add(`tile-cell--${2*parseInt(n.textContent)}`),n.textContent=2*parseInt(n.textContent),this.tempTiles.push(i),this.removedItems.push(t),this.changed++)}}}}moveDown(){for(let t of this.tiles.sort((t,e)=>this.getCoords(e).y-this.getCoords(t).y)){let e=this.getCoords(t);t.classList.remove(e.className);let s=3;for(;this.tiles.filter(t=>t.classList.contains(`tile-cell--${s}--${e.x}`)).length>0&&!(--s<0););if(s<0&&(s=e.y),s>=0&&parseInt(e.y)!==s&&this.changed++,t.classList.add(`tile-cell--${s}--${e.x}`),s<3){let l=s+1,i=this.tiles.filter(t=>t.classList.contains(`tile-cell--${l}--${e.x}`))[0];if(i){let n=i.querySelector(".tile-content"),o=t.querySelector(".tile-content");n.textContent===o.textContent&&!this.tempTiles.includes(i)&&(t.classList.remove(`tile-cell--${s}--${e.x}`),t.classList.add(`tile-cell--${l}--${e.x}`),t.classList.add("tile-cell--hide"),i.classList.remove(`tile-cell--${n.textContent}`),i.classList.add(`tile-cell--${2*parseInt(n.textContent)}`),n.textContent=2*parseInt(n.textContent),this.tempTiles.push(i),this.removedItems.push(t),this.changed++)}}}}getScore(){let t=this.getState(),e=0;for(let s=0;s<4;s++)for(let l=0;l<4;l++)e+=t[s][l];return e}getState(){let t=[];for(let e=0;e<4;e++)t.push([0,0,0,0]);for(let e of this.tiles.filter(t=>!t.classList.contains("tile-cell--hide"))){let s=this.getCoords(e);t[s.y][s.x]=parseInt(e.querySelector(".tile-content").innerHTML)}return t}getStatus(){return this.tiles.filter(t=>2048===parseInt(t.querySelector(".tile-content").innerHTML)).length>0?"win":this.checkPosibilityToContinue()?document.getElementsByClassName("button")[0].classList.contains("start")?"idle":"playing":"lose"}start(){let t=document.getElementsByClassName("button")[0];this.tiles=[],t.addEventListener("click",this.connectStart.bind(this)),document.addEventListener("keydown",this.press.bind(this))}restart(){this.start()}connectStart(t){t.preventDefault();let e=t.target;this.tiles=[],document.getElementById("tile-container").innerHTML="",e.classList.contains("start")&&(e.classList.remove("start"),e.classList.add("restart"),e.textContent="Restart"),this.spawnItem(),this.spawnItem();let s=[...document.getElementsByClassName("message")].filter(t=>!t.classList.contains("hidden"))[0];s&&s.classList.add("hidden"),document.getElementsByClassName("message-start")[0].classList.remove("hidden")}press(t){let e=t.key;if(this.tempTiles=[],this.removedItems=[],this.changed=0,0!==this.tiles.length){switch(e){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}this.sleep().then(()=>{for(let t=0;t<this.removedItems.length;t++)this.removedItems[t].remove();if(this.changed>0&&this.spawnItem(),!this.checkPosibilityToContinue()){document.addEventListener("keydown",()=>{});let t=this.getStatus();document.getElementsByClassName("message-start")[0].classList.add("hidden"),document.getElementsByClassName(`message-${t}`)[0].classList.remove("hidden")}})}}setScoreHTML(){document.getElementsByClassName("game-score")[0].textContent=this.getScore()}spawnItem(){let t=this.tiles.filter(t=>!t.classList.contains("tile-cell--hide"));if(t.length<16){let e=document.createElement("div"),s=2>Math.round(10*Math.random())?4:2,l=Math.floor(4*Math.random()),i=Math.floor(4*Math.random());for(;t.filter(t=>t.classList.contains(`tile-cell--${i}--${l}`)).length>0;)l=Math.floor(4*Math.random()),i=Math.floor(4*Math.random());e.classList.add("tile-cell"),e.classList.add(`tile-cell--${s}`),e.classList.add(`tile-cell--${i}--${l}`),e.classList.add("tile-cell--hide");let n=document.createElement("p");n.classList.add("tile-content"),n.textContent=s,e.appendChild(n),this.container.append(e),this.tiles.push(e),e.classList.remove("tile-cell--hide"),this.setScoreHTML()}}sleep(t=200){return new Promise(e=>{setTimeout(()=>{e()},t)})}getCoords(t){let e=0,s=0,l="";for(let i of t.classList)i.length>=15&&"tile-cell--hide"!==i&&(e=i.slice(-1),s=i.slice(-4,-3),l=i);return{x:e,y:s,className:l}}checkPosibilityToContinue(){if(this.tiles=this.tiles.filter(t=>!t.classList.contains("tile-cell--hide")),this.tiles.length>=16){for(let t=0;t<this.tiles.length;t++){let e=this.tiles[t].querySelector(".tile-content"),s=this.getCoords(this.tiles[t]);if(s.x>0){let t=this.tiles.filter(t=>t.classList.contains(`tile-cell--${s.y}--${s.x-1}`))[0];if(t&&e.textContent===t.querySelector(".tile-content").textContent)return!0}if(s.y>0){let t=this.tiles.filter(t=>t.classList.contains(`tile-cell--${s.y-1}--${s.x}`))[0];if(t&&e.textContent===t.querySelector(".tile-content").textContent)return!0}if(s.y<3){let t=this.tiles.filter(t=>t.classList.contains(`tile-cell--${s.y+1}--${s.x}`))[0];if(t&&e.textContent===t.querySelector(".tile-content").textContent)return!0}if(s.x<3){let t=this.tiles.filter(t=>t.classList.contains(`tile-cell--${s.y}--${s.x+1}`))[0];if(t&&e.textContent===t.querySelector(".tile-content").textContent)return!0}}return!1}return!0}convertToTiles(t){document.getElementById("tile-container").innerHTML="";for(let e=0;e<4;e++)for(let s=0;s<4;s++)if(t[e][s]>0){let l=document.createElement("div");l.classList.add("tile-cell"),l.classList.add(`tile-cell--${t[e][s]}`),l.classList.add(`tile-cell--${e}--${s}`);let i=document.createElement("p");i.classList.add("tile-content"),i.textContent=t[e][s],l.appendChild(i),document.getElementById("tile-container").appendChild(l),this.tiles.add(l)}}}().start();
//# sourceMappingURL=index.a8eaab70.js.map
